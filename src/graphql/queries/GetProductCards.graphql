# Query for product cards using our custom mesh query
# Returns canonically formatted data ready for display
# Now supports facets for dynamic filtering and sorting

query GetProductCards(
  $phrase: String
  $filter: Citisignal_ProductFilter
  $sort: Citisignal_SortInput
  $limit: Int = 20
  $page: Int = 1
  $facets: Boolean = false
) {
  Citisignal_productCards(
    phrase: $phrase
    filter: $filter
    sort: $sort
    limit: $limit
    page: $page
    facets: $facets
  ) {
    items {
      id
      sku
      urlKey
      name
      manufacturer
      price           # Formatted "$999.99"
      originalPrice   # Only when on sale
      discountPercent
      inStock
      image {
        url
        altText
      }
      memory
      colors {
        name
        hex
      }
    }
    totalCount
    hasMoreItems
    currentPage
    facets {          # Dynamic facets from Live Search
      attribute
      label
      options {
        label
        value
        count
      }
    }
  }
}